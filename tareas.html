<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tareas | EST-46111: Fundamentos de Estadística con Remuestreo</title>
  <meta name="description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2020." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Tareas | EST-46111: Fundamentos de Estadística con Remuestreo" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2020." />
  <meta name="github-repo" content="tereom/fundamentos" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tareas | EST-46111: Fundamentos de Estadística con Remuestreo" />
  
  <meta name="twitter:description" content="Curso de Fundamentos de Estadística con Remuestreo, maestría en Ciencia de Datos, ITAM, Otoño 2020." />
  

<meta name="author" content="Teresa Ortiz (001), Alfredo Garbuno (002), Felipe González" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimación-por-máxima-verosimilitud.html"/>
<link rel="next" href="referencias.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamentos de Estadística con Remuestreo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Información del curso</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#temario"><i class="fa fa-check"></i>Temario</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#evaluación"><i class="fa fa-check"></i>Evaluación</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html"><i class="fa fa-check"></i><b>1</b> Principios de visualización</a><ul>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#el-cuarteto-de-ascombe"><i class="fa fa-check"></i>El cuarteto de Ascombe</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#introducción"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#visualización-popular-de-datos"><i class="fa fa-check"></i>Visualización popular de datos</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#teoría-de-visualización-de-datos"><i class="fa fa-check"></i>Teoría de visualización de datos</a><ul>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#principios-generales-del-diseño-analítico"><i class="fa fa-check"></i>Principios generales del diseño analítico</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#técnicas-de-visualización"><i class="fa fa-check"></i>Técnicas de visualización</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#indicadores-de-calidad-gráfica"><i class="fa fa-check"></i>Indicadores de calidad gráfica</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#factor-de-engaño-y-chartjunk"><i class="fa fa-check"></i>Factor de engaño y Chartjunk</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#pequeños-múltiplos-y-densidad-gráfica"><i class="fa fa-check"></i>Pequeños múltiplos y densidad gráfica</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#tinta-de-datos"><i class="fa fa-check"></i>Tinta de datos</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#decoración"><i class="fa fa-check"></i>Decoración</a></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#percepción-de-escala"><i class="fa fa-check"></i>Percepción de escala</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="principios-de-visualización.html"><a href="principios-de-visualización.html#ejemplo-gráfica-de-minard"><i class="fa fa-check"></i>Ejemplo: gráfica de Minard</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html"><i class="fa fa-check"></i><b>2</b> Análisis exploratorio</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#el-papel-de-la-exploración-en-el-análisis-de-datos"><i class="fa fa-check"></i>El papel de la exploración en el análisis de datos</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#algunos-conceptos-básicos"><i class="fa fa-check"></i>Algunos conceptos básicos</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#media-y-desviación-estándar"><i class="fa fa-check"></i>Media y desviación estándar</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#ejemplos"><i class="fa fa-check"></i>Ejemplos</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#precios-de-casas"><i class="fa fa-check"></i>Precios de casas</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#prueba-enlace"><i class="fa fa-check"></i>Prueba Enlace</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#estados-y-calificaciones-en-sat"><i class="fa fa-check"></i>Estados y calificaciones en SAT</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#tablas-de-conteos"><i class="fa fa-check"></i>Tablas de conteos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#loess"><i class="fa fa-check"></i>Loess</a><ul>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#ajustando-curvas-loess"><i class="fa fa-check"></i>Ajustando curvas loess</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#series-de-tiempo"><i class="fa fa-check"></i>Series de tiempo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html"><i class="fa fa-check"></i><b>3</b> Tipos de estudio y experimentos</a><ul>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#motivación"><i class="fa fa-check"></i>Motivación</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#proceso-generador-de-datos"><i class="fa fa-check"></i>Proceso Generador de Datos</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#ejemplo-prevalencia-de-anemia"><i class="fa fa-check"></i>Ejemplo: Prevalencia de anemia</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#muestreo-aleatorio"><i class="fa fa-check"></i>Muestreo aleatorio</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#pero-si-no-podemos-hacer-muestreo-aleatorio"><i class="fa fa-check"></i>Pero si no podemos hacer muestreo aleatorio?</a><ul>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#ejemplo-policías-y-tráfico"><i class="fa fa-check"></i>Ejemplo: Policías y tráfico</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#el-estimador-estándar"><i class="fa fa-check"></i>El estimador estándar</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#experimentos-tradicionales"><i class="fa fa-check"></i>Experimentos tradicionales</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#bloqueo"><i class="fa fa-check"></i>Bloqueo</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#variables-desconocidas"><i class="fa fa-check"></i>Variables desconocidas</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#aleatorizando-el-tratamiento"><i class="fa fa-check"></i>Aleatorizando el tratamiento</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#resumen-selección-de-unidades-y-tratamiento"><i class="fa fa-check"></i>Resumen: selección de unidades y tratamiento</a></li>
<li class="chapter" data-level="" data-path="tipos-de-estudio-y-experimentos.html"><a href="tipos-de-estudio-y-experimentos.html#asignación-natural-del-tratamiento"><i class="fa fa-check"></i>Asignación natural del tratamiento</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html"><i class="fa fa-check"></i><b>4</b> Pruebas de hipótesis</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#comparación-con-poblaciones-de-referencia"><i class="fa fa-check"></i>Comparación con poblaciones de referencia</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#comparando-distribuciones"><i class="fa fa-check"></i>Comparando distribuciones</a></li>
<li><a href="pruebas-de-hipótesis.html#prueba-de-permutaciones-y-el-lineup">Prueba de permutaciones y el <em>lineup</em></a></li>
<li><a href="pruebas-de-hipótesis.html#comparaciones-usando-lineup-continuación">Comparaciones usando <em>lineup</em> (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-de-permutaciones-para-proporciones"><i class="fa fa-check"></i>Prueba de permutaciones para proporciones</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-de-hipótesis-tradicionales"><i class="fa fa-check"></i>Pruebas de hipótesis tradicionales</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#tomadores-de-té-continuación"><i class="fa fa-check"></i>Tomadores de té (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-de-permutación-implementación"><i class="fa fa-check"></i>Pruebas de permutación: Implementación</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-tiempos-de-fusión"><i class="fa fa-check"></i>Ejemplo: tiempos de fusión</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-tiempos-de-fusión-continuación"><i class="fa fa-check"></i>Ejemplo: tiempos de fusión (continuación)</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#separación-de-grupos"><i class="fa fa-check"></i>Separación de grupos</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#avispas-opcional"><i class="fa fa-check"></i>Avispas (opcional)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#la-crisis-de-replicabilidad"><i class="fa fa-check"></i>La “crisis de replicabilidad”</a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#el-jardín-de-los-senderos-que-se-bifurcan"><i class="fa fa-check"></i>El jardín de los senderos que se bifurcan</a></li>
<li><a href="pruebas-de-hipótesis.html#ejemplo-decisiones-de-análisis-y-valores-p">Ejemplo: decisiones de análisis y valores <em>p</em></a></li>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#alternativas-o-soluciones"><i class="fa fa-check"></i>Alternativas o soluciones</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html"><i class="fa fa-check"></i><b>5</b> Estimación y distribución de muestreo</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-precios-de-casas"><i class="fa fa-check"></i>Ejemplo: precios de casas</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#distribución-de-muestreo"><i class="fa fa-check"></i>Distribución de muestreo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#más-ejemplos"><i class="fa fa-check"></i>Más ejemplos</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#el-error-estándar"><i class="fa fa-check"></i>El error estándar</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-valor-de-casas"><i class="fa fa-check"></i>Ejemplo: valor de casas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#calculando-la-distribución-de-muestreo"><i class="fa fa-check"></i>Calculando la distribución de muestreo</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#teorema-central-del-límite"><i class="fa fa-check"></i>Teorema central del límite</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#normalidad-y-gráficas-de-cuantiles-normales"><i class="fa fa-check"></i>Normalidad y gráficas de cuantiles normales</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#prueba-de-hipótesis-de-normalidad"><i class="fa fa-check"></i>Prueba de hipótesis de normalidad</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#más-del-teorema-central-del-límite"><i class="fa fa-check"></i>Más del Teorema central del límite</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html"><i class="fa fa-check"></i><b>6</b> Intervalos de confianza y remuestreo</a><ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-introductorio"><i class="fa fa-check"></i>Ejemplo introductorio</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#la-idea-del-bootstrap"><i class="fa fa-check"></i>La idea del bootstrap</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#el-principio-de-plug-in"><i class="fa fa-check"></i>El principio de plug-in</a><ul>
<li class="chapter" data-level="" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#discusión-propiedades-de-la-distribución-bootstrap"><i class="fa fa-check"></i>Discusión: propiedades de la distribución bootstrap</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#variación-en-distribuciones-bootstrap"><i class="fa fa-check"></i>Variación en distribuciones bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#error-estándar-bootstrap-e-intervalos-normales"><i class="fa fa-check"></i>Error estándar bootstrap e intervalos normales</a><ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-tomadores-de-té-negro"><i class="fa fa-check"></i>Ejemplo: tomadores de té negro</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-inventario-de-casas-vendidas"><i class="fa fa-check"></i>Ejemplo: inventario de casas vendidas</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#calibración-de-intervalos-de-confianza"><i class="fa fa-check"></i>Calibración de intervalos de confianza</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#interpretación-de-intervalos-de-confianza"><i class="fa fa-check"></i>Interpretación de intervalos de confianza</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#intervalos-bootstrap-de-percentiles"><i class="fa fa-check"></i>Intervalos bootstrap de percentiles</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-para-dos-muestras"><i class="fa fa-check"></i>Bootstrap para dos muestras</a><ul>
<li class="chapter" data-level="" data-path="S-distribucion-muestreo.html"><a href="S-distribucion-muestreo.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#datos-pareados"><i class="fa fa-check"></i>Datos pareados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-otras-estadísticas"><i class="fa fa-check"></i>Bootstrap y otras estadísticas</a><ul>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-estimadores-de-razón"><i class="fa fa-check"></i>Ejemplo: estimadores de razón</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#ejemplo-suavizadores"><i class="fa fa-check"></i>Ejemplo: suavizadores</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-estimadores-complejos-tablas-de-perfiles"><i class="fa fa-check"></i>Bootstrap y estimadores complejos: tablas de perfiles</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#bootstrap-y-muestras-complejas"><i class="fa fa-check"></i>Bootstrap y muestras complejas</a></li>
<li class="chapter" data-level="" data-path="intervalos-de-confianza-y-remuestreo.html"><a href="intervalos-de-confianza-y-remuestreo.html#conclusiones-y-observaciones"><i class="fa fa-check"></i>Conclusiones y observaciones</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html"><i class="fa fa-check"></i><b>7</b> Estimación por máxima verosimilitud</a><ul>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#introducción-a-estimación-por-máxima-verosimilitud"><i class="fa fa-check"></i>Introducción a estimación por máxima verosimilitud</a></li>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#máxima-verosimilitud-para-observaciones-continuas"><i class="fa fa-check"></i>Máxima verosimilitud para observaciones continuas</a></li>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#aspectos-numéricos"><i class="fa fa-check"></i>Aspectos numéricos</a><ul>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#el-método-de-momentos"><i class="fa fa-check"></i>El método de momentos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#máxima-verosimilitud-para-más-de-un-parámetro"><i class="fa fa-check"></i>Máxima verosimilitud para más de un parámetro</a></li>
<li class="chapter" data-level="" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#bootstrap-paramétrico"><i class="fa fa-check"></i>Bootstrap paramétrico</a></li>
<li class="chapter" data-level="7.1" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#ventajas-y-desventajas-de-bootstrap-paramétrico"><i class="fa fa-check"></i><b>7.1</b> Ventajas y desventajas de bootstrap paramétrico</a></li>
<li class="chapter" data-level="7.2" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#verificando-los-supuestos-distribucionales"><i class="fa fa-check"></i><b>7.2</b> Verificando los supuestos distribucionales</a></li>
<li class="chapter" data-level="7.3" data-path="estimación-por-máxima-verosimilitud.html"><a href="estimación-por-máxima-verosimilitud.html#modelos-mal-indentificados"><i class="fa fa-check"></i><b>7.3</b> Modelos mal indentificados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html"><i class="fa fa-check"></i>Tareas</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#anáslisis-exploratorio"><i class="fa fa-check"></i>1. Anáslisis Exploratorio</a></li>
<li class="chapter" data-level="" data-path="análisis-exploratorio.html"><a href="análisis-exploratorio.html#loess"><i class="fa fa-check"></i>2. Loess</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución-series-de-tiempo"><i class="fa fa-check"></i>Solución: Series de tiempo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#tipos-de-estudio-y-pgd"><i class="fa fa-check"></i>3. Tipos de estudio y PGD</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#pruebas-de-hipótesis-visuales-y-permutación"><i class="fa fa-check"></i>4. Pruebas de hipótesis visuales y permutación</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución-pruebas-pareadas"><i class="fa fa-check"></i>Solución: Pruebas pareadas</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#distribución-muestral-y-remuestreo"><i class="fa fa-check"></i>5. Distribución muestral y remuestreo</a></li>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#tcl-e-introducción-a-bootstrap"><i class="fa fa-check"></i>6. TCL e introducción a bootstrap</a><ul>
<li class="chapter" data-level="" data-path="tareas.html"><a href="tareas.html#solución-y-discusión-de-media"><i class="fa fa-check"></i>Solución y discusión de media</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EST-46111: Fundamentos de Estadística con Remuestreo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tareas" class="section level1 unnumbered">
<h1>Tareas</h1>
<ul>
<li><p>Las tareas se envían por correo a <a href="mailto:teresa.ortiz.mancera@gmail.com" class="email">teresa.ortiz.mancera@gmail.com</a> con título:
fundamentos-tareaXX (donde XX corresponde al número de tarea, 01..).</p></li>
<li><p>Las tareas deben incluir código y resultados (si conocen <a href="https://rmarkdown.rstudio.com">Rmarkdown</a> es muy conveniente para este propósito).</p></li>
</ul>
<div id="anáslisis-exploratorio" class="section level2 unnumbered">
<h2>1. Anáslisis Exploratorio</h2>
<p>Realicen los ejercicios del script 01_exploratorio.R que vimos la clase pasada (RStudio.cloud proyecto 01-exploratorio). Escriban las respuestas en un reporte
que incluya código y resultados (puede ser word, html, pdf,…).</p>
</div>
<div id="loess" class="section level2 unnumbered">
<h2>2. Loess</h2>
<p>La tarea 2 es el proyecto de RStudio.Cloud con este nombre, el ejercicio está
en un archvio de R Markdown, para los que son nuevos con R Markdown deben
escribir su código en los bloques de código (secciones grises entre
```{r} codigo ```) una vez que escriban sus respuestas pueden generar el reporte tejiendo el documento, para esto deben presionar el botón <em>Knit</em>. Envíen el
reporte por correo electrónico (con título fundamentos-tarea02).</p>
<div id="solución-series-de-tiempo" class="section level3 unnumbered">
<h3>Solución: Series de tiempo</h3>
<p>Podemos usar el suavizamiento loess para entender y describir el comportamiento
de series de tiempo, en las cuales intentamos entender la dependencia de una
serie de mediciones indexadas por el tiempo. Típicamente es necesario utilizar
distintas <em>componentes</em> para describir exitosamente una serie de tiempo, y para
esto usamos distintos tipos de suavizamientos. Veremos que distintas
<em>componentes</em> varían en distintas escalas de tiempo (unas muy lentas, cono la
tendencia, otras más rapidamente, como variación quincenal, etc.).</p>
<p>En el siguiente ejemplo consideramos la ventas semanales de un producto a lo
largo de 5 años. Veamos que existe una tendencia a largo plazo (crecimientos
anuales) y también que existen patrones de variación estacionales.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="tareas.html#cb343-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb343-2"><a href="tareas.html#cb343-2"></a>ventas &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/ventas_semanal.csv&quot;</span>)</span>
<span id="cb343-3"><a href="tareas.html#cb343-3"></a><span class="kw">head</span>(ventas)</span></code></pre></div>
<pre><code>##   period sales.kg
## 1      1  685.537
## 2      2  768.234
## 3      3  894.643
## 4      4  773.501
## 5      5  954.600
## 6      6  852.853</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="tareas.html#cb345-1"></a><span class="kw">ggplot</span>(ventas, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> sales.kg)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-1-1.png" width="528" /></p>
<p>Intentaremos usar suavizamiento para capturar los distintos tipos de variación
que observamos en la serie. En primer lugar, si suavizamos poco (por ejemplo
<span class="math inline">\(\aplha = 0.1\)</span>), vemos que capturamos en parte la tendencia y en parte la
variación estacional.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="tareas.html#cb346-1"></a><span class="kw">ggplot</span>(ventas, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> <span class="kw">log</span>(sales.kg))) <span class="op">+</span></span>
<span id="cb346-2"><a href="tareas.html#cb346-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb346-3"><a href="tareas.html#cb346-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">span =</span> <span class="fl">0.1</span>, <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>), </span>
<span id="cb346-4"><a href="tareas.html#cb346-4"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb346-5"><a href="tareas.html#cb346-5"></a>    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-2-1.png" width="528" /></p>
<p>Es mejor comenzar capturando la tendencia, y poco de la componente estacional:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="tareas.html#cb348-1"></a><span class="kw">ggplot</span>(ventas, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> <span class="kw">log</span>(sales.kg))) <span class="op">+</span></span>
<span id="cb348-2"><a href="tareas.html#cb348-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb348-3"><a href="tareas.html#cb348-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">span =</span> <span class="fl">0.3</span>, <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>), </span>
<span id="cb348-4"><a href="tareas.html#cb348-4"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb348-5"><a href="tareas.html#cb348-5"></a>    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-3-1.png" width="528" /></p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="tareas.html#cb350-1"></a>ajuste.trend<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">loess</span>(<span class="kw">log</span>(sales.kg) <span class="op">~</span><span class="st"> </span>period, ventas, <span class="dt">span =</span> <span class="fl">0.3</span>, <span class="dt">degree =</span> <span class="dv">1</span>)</span>
<span id="cb350-2"><a href="tareas.html#cb350-2"></a>ventas<span class="op">$</span>trend<span class="fl">.1</span> &lt;-<span class="st"> </span>ajuste.trend<span class="fl">.1</span><span class="op">$</span>fitted</span>
<span id="cb350-3"><a href="tareas.html#cb350-3"></a>ventas<span class="op">$</span>res.trend<span class="fl">.1</span> &lt;-<span class="st"> </span>ajuste.trend<span class="fl">.1</span><span class="op">$</span>residuals</span></code></pre></div>
<p>Ahora calculamos los residuales de este ajuste e intentamos describirlos
mediante un suavizamiento más fino. Verificamos que hemos estimado la mayor
parte de la tendencia, e intentamos capturar la variación estacional de los
residuales.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="tareas.html#cb351-1"></a><span class="kw">ggplot</span>(ventas, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> res.trend<span class="fl">.1</span>)) <span class="op">+</span></span>
<span id="cb351-2"><a href="tareas.html#cb351-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb351-3"><a href="tareas.html#cb351-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">span =</span> <span class="fl">0.15</span>, <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>), </span>
<span id="cb351-4"><a href="tareas.html#cb351-4"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb351-5"><a href="tareas.html#cb351-5"></a>    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-4-1.png" width="528" /></p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="tareas.html#cb353-1"></a>ajuste.est1<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">loess</span>(res.trend<span class="fl">.1</span> <span class="op">~</span><span class="st"> </span>period, ventas, <span class="dt">span =</span> <span class="fl">0.15</span>, <span class="dt">degree =</span> <span class="dv">1</span>)</span>
<span id="cb353-2"><a href="tareas.html#cb353-2"></a>ventas<span class="op">$</span>est1<span class="fl">.1</span> &lt;-<span class="st"> </span>ajuste.est1<span class="fl">.1</span><span class="op">$</span>fitted</span>
<span id="cb353-3"><a href="tareas.html#cb353-3"></a>ventas<span class="op">$</span>res.est1<span class="fl">.1</span> &lt;-<span class="st"> </span>ajuste.est1<span class="fl">.1</span><span class="op">$</span>residuals</span></code></pre></div>
<p>Y graficamos los residuales obtenidos después de ajustar el componente
estacional para estudiar la componente de mayor frecuencia.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="tareas.html#cb354-1"></a><span class="kw">ggplot</span>(ventas, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> res.est1<span class="fl">.1</span>)) <span class="op">+</span></span>
<span id="cb354-2"><a href="tareas.html#cb354-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb354-3"><a href="tareas.html#cb354-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">span =</span> <span class="fl">0.06</span>, <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>), </span>
<span id="cb354-4"><a href="tareas.html#cb354-4"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb354-5"><a href="tareas.html#cb354-5"></a>    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-5-1.png" width="528" /></p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="tareas.html#cb356-1"></a>ajuste.est2<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">loess</span>(res.est1<span class="fl">.1</span> <span class="op">~</span><span class="st"> </span>period, ventas, <span class="dt">span =</span> <span class="fl">0.06</span>, <span class="dt">degree =</span> <span class="dv">1</span>)</span>
<span id="cb356-2"><a href="tareas.html#cb356-2"></a>ventas<span class="op">$</span>est2<span class="fl">.1</span> &lt;-<span class="st"> </span>ajuste.est2<span class="fl">.1</span><span class="op">$</span>fitted</span>
<span id="cb356-3"><a href="tareas.html#cb356-3"></a>ventas<span class="op">$</span>res.est2<span class="fl">.1</span> &lt;-<span class="st"> </span>ajuste.est2<span class="fl">.1</span><span class="op">$</span>residuals</span></code></pre></div>
<p>Ahora que tenemos nuestra primera estimación de cada una de las componentes,
podemos regresar a hacer una mejor estimación de la tendencia. La ventaja de
volver es que ahora podemos suavizar más sin que en nuestra muestra compita
tanto la variación estacional. Por tanto podemos suavizar menos:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="tareas.html#cb357-1"></a>ventas<span class="op">$</span>sales.sin.est<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">log</span>(ventas<span class="op">$</span>sales.kg) <span class="op">-</span><span class="st"> </span>ajuste.est1<span class="fl">.1</span><span class="op">$</span>fitted <span class="op">-</span><span class="st"> </span></span>
<span id="cb357-2"><a href="tareas.html#cb357-2"></a><span class="st">  </span>ajuste.est2<span class="fl">.1</span><span class="op">$</span>fitted</span>
<span id="cb357-3"><a href="tareas.html#cb357-3"></a></span>
<span id="cb357-4"><a href="tareas.html#cb357-4"></a><span class="kw">ggplot</span>(ventas, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> sales.sin.est<span class="fl">.1</span>)) <span class="op">+</span></span>
<span id="cb357-5"><a href="tareas.html#cb357-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb357-6"><a href="tareas.html#cb357-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">span =</span> <span class="fl">0.09</span>, <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>), </span>
<span id="cb357-7"><a href="tareas.html#cb357-7"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb357-8"><a href="tareas.html#cb357-8"></a>    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-6-1.png" width="528" /></p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="tareas.html#cb359-1"></a>ajuste.trend<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">loess</span>(sales.sin.est<span class="fl">.1</span> <span class="op">~</span><span class="st"> </span>period, ventas, <span class="dt">span =</span> <span class="fl">0.08</span>, <span class="dt">degree =</span> <span class="dv">1</span>)</span>
<span id="cb359-2"><a href="tareas.html#cb359-2"></a>ventas<span class="op">$</span>trend<span class="fl">.2</span> &lt;-<span class="st"> </span>ajuste.trend<span class="fl">.2</span><span class="op">$</span>fitted</span>
<span id="cb359-3"><a href="tareas.html#cb359-3"></a>ventas<span class="op">$</span>res.trend<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">log</span>(ventas<span class="op">$</span>sales.kg) <span class="op">-</span><span class="st"> </span>ventas<span class="op">$</span>trend<span class="fl">.2</span></span></code></pre></div>
<p>Y ahora nos concentramos en la componente anual.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="tareas.html#cb360-1"></a>ventas<span class="op">$</span>sales.sin.est<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">log</span>(ventas<span class="op">$</span>sales.kg) <span class="op">-</span><span class="st"> </span>ajuste.trend<span class="fl">.2</span><span class="op">$</span>fitted <span class="op">-</span></span>
<span id="cb360-2"><a href="tareas.html#cb360-2"></a><span class="st">  </span>ajuste.est2<span class="fl">.1</span><span class="op">$</span>fitted</span>
<span id="cb360-3"><a href="tareas.html#cb360-3"></a><span class="kw">ggplot</span>(ventas, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> sales.sin.est<span class="fl">.2</span>)) <span class="op">+</span></span>
<span id="cb360-4"><a href="tareas.html#cb360-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb360-5"><a href="tareas.html#cb360-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">span =</span> <span class="fl">0.15</span>, <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">2</span>), </span>
<span id="cb360-6"><a href="tareas.html#cb360-6"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb360-7"><a href="tareas.html#cb360-7"></a>    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-7-1.png" width="528" /></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="tareas.html#cb362-1"></a>ajuste.est1<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">loess</span>(sales.sin.est<span class="fl">.2</span> <span class="op">~</span><span class="st"> </span>period, ventas, <span class="dt">span =</span> <span class="fl">0.15</span>, <span class="dt">degree =</span> <span class="dv">1</span>)</span>
<span id="cb362-2"><a href="tareas.html#cb362-2"></a>ventas<span class="op">$</span>est1<span class="fl">.2</span> &lt;-<span class="st"> </span>ajuste.est1<span class="fl">.2</span><span class="op">$</span>fitted</span>
<span id="cb362-3"><a href="tareas.html#cb362-3"></a>ventas<span class="op">$</span>res.est1<span class="fl">.2</span> &lt;-<span class="st"> </span>ajuste.est1<span class="fl">.2</span><span class="op">$</span>residuals</span></code></pre></div>
<p>Finalmente volvemos a ajustar la componente de frecuencia más alta:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="tareas.html#cb363-1"></a>ventas<span class="op">$</span>sales.sin.est<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">log</span>(ventas<span class="op">$</span>sales.kg) <span class="op">-</span><span class="st"> </span>ajuste.trend<span class="fl">.2</span><span class="op">$</span>fitted <span class="op">-</span></span>
<span id="cb363-2"><a href="tareas.html#cb363-2"></a><span class="st">  </span>ajuste.est1<span class="fl">.2</span><span class="op">$</span>fitted</span>
<span id="cb363-3"><a href="tareas.html#cb363-3"></a></span>
<span id="cb363-4"><a href="tareas.html#cb363-4"></a><span class="kw">ggplot</span>(ventas, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> sales.sin.est<span class="fl">.3</span>)) <span class="op">+</span></span>
<span id="cb363-5"><a href="tareas.html#cb363-5"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb363-6"><a href="tareas.html#cb363-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">span =</span> <span class="fl">0.06</span>, <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>), </span>
<span id="cb363-7"><a href="tareas.html#cb363-7"></a>              <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb363-8"><a href="tareas.html#cb363-8"></a>    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-8-1.png" width="528" /></p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="tareas.html#cb365-1"></a>ajuste.est2<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">loess</span>(sales.sin.est<span class="fl">.3</span> <span class="op">~</span><span class="st"> </span>period, ventas, <span class="dt">span =</span> <span class="fl">0.06</span>, <span class="dt">degree =</span> <span class="dv">1</span>)</span>
<span id="cb365-2"><a href="tareas.html#cb365-2"></a>ventas<span class="op">$</span>est2<span class="fl">.2</span> &lt;-<span class="st"> </span>ajuste.est2<span class="fl">.2</span><span class="op">$</span>fitted</span>
<span id="cb365-3"><a href="tareas.html#cb365-3"></a>ventas<span class="op">$</span>res.est2<span class="fl">.2</span> &lt;-<span class="st"> </span>ajuste.est2<span class="fl">.2</span><span class="op">$</span>residuals</span></code></pre></div>
<p>Verificamos nuestra descomposición y visualizamos el ajuste:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="tareas.html#cb366-1"></a>ventas<span class="op">$</span>log.sales &lt;-<span class="st"> </span><span class="kw">log</span>(ventas<span class="op">$</span>sales.kg)</span>
<span id="cb366-2"><a href="tareas.html#cb366-2"></a>ventas<span class="fl">.2</span> &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(ventas, period, trend<span class="fl">.2</span>, est1<span class="fl">.2</span>, est2<span class="fl">.2</span>, res.est2<span class="fl">.2</span>, </span>
<span id="cb366-3"><a href="tareas.html#cb366-3"></a>  log.sales)</span>
<span id="cb366-4"><a href="tareas.html#cb366-4"></a><span class="kw">max</span>(<span class="kw">abs</span>(<span class="kw">apply</span>(ventas<span class="fl">.2</span>[, <span class="dv">2</span><span class="op">:</span><span class="dv">4</span>], <span class="dv">1</span>, sum) <span class="op">-</span><span class="st"> </span>ventas<span class="fl">.2</span><span class="op">$</span>log.sales))</span></code></pre></div>
<pre><code>## [1] 0.240316</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="tareas.html#cb368-1"></a>ventas.<span class="fl">2.</span>m &lt;-<span class="st"> </span><span class="kw">gather</span>(ventas<span class="fl">.2</span>, componente, valor, <span class="op">-</span>period)</span>
<span id="cb368-2"><a href="tareas.html#cb368-2"></a></span>
<span id="cb368-3"><a href="tareas.html#cb368-3"></a>ventas.<span class="fl">2.</span>m.c &lt;-<span class="st"> </span>ventas.<span class="fl">2.</span>m <span class="op">%&gt;%</span></span>
<span id="cb368-4"><a href="tareas.html#cb368-4"></a><span class="st">  </span><span class="kw">group_by</span>(componente) <span class="op">%&gt;%</span></span>
<span id="cb368-5"><a href="tareas.html#cb368-5"></a><span class="st">  </span><span class="kw">mutate</span>(</span>
<span id="cb368-6"><a href="tareas.html#cb368-6"></a>    <span class="dt">valor.c =</span> valor <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(valor), </span>
<span id="cb368-7"><a href="tareas.html#cb368-7"></a>    <span class="dt">componente =</span> <span class="kw">factor</span>(componente, <span class="kw">c</span>(<span class="st">&quot;trend.2&quot;</span>, <span class="st">&quot;est1.2&quot;</span>, <span class="st">&quot;est2.2&quot;</span>, </span>
<span id="cb368-8"><a href="tareas.html#cb368-8"></a>                                           <span class="st">&quot;res.est2.2&quot;</span>, <span class="st">&quot;log.sales&quot;</span>))</span>
<span id="cb368-9"><a href="tareas.html#cb368-9"></a>  )</span>
<span id="cb368-10"><a href="tareas.html#cb368-10"></a></span>
<span id="cb368-11"><a href="tareas.html#cb368-11"></a><span class="kw">ggplot</span>(ventas.<span class="fl">2.</span>m.c, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> valor.c)) <span class="op">+</span></span>
<span id="cb368-12"><a href="tareas.html#cb368-12"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">52</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">52</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">52</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">52</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></span>
<span id="cb368-13"><a href="tareas.html#cb368-13"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb368-14"><a href="tareas.html#cb368-14"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>componente, <span class="dt">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-9-1.png" width="528" /></p>
<p>Y vemos que es razonable describir los residuales con una distribución normal
(con desviación estándar alrededor de 8% sobre el valor ajustado):</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="tareas.html#cb369-1"></a><span class="kw">sd</span>(ventas<span class="op">$</span>res.est2<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## [1] 0.08093687</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="tareas.html#cb371-1"></a>ventas.ord &lt;-<span class="st"> </span><span class="kw">arrange</span>(ventas, res.est2<span class="fl">.2</span>)</span>
<span id="cb371-2"><a href="tareas.html#cb371-2"></a>ventas.ord<span class="op">$</span>q.normal &lt;-<span class="st"> </span><span class="kw">qnorm</span>((<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ventas) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(ventas))</span>
<span id="cb371-3"><a href="tareas.html#cb371-3"></a><span class="kw">ggplot</span>(ventas.ord, <span class="kw">aes</span>(<span class="dt">x =</span> q.normal, <span class="dt">y =</span> res.est2<span class="fl">.2</span>)) <span class="op">+</span></span>
<span id="cb371-4"><a href="tareas.html#cb371-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span></span>
<span id="cb371-5"><a href="tareas.html#cb371-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-10-1.png" width="345.6" /></p>
<p>Aún no estamos convencidos de que podemos hacer <em>pooling</em> de los residuales.
Para checar esto, vemos la gráfica de dependencia de residuales.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="tareas.html#cb373-1"></a><span class="kw">ggplot</span>(ventas, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> res.est2<span class="fl">.2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb373-2"><a href="tareas.html#cb373-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-11-1.png" width="528" /></p>
<p>¿Puedes notar alguna dependencia en los residuales?</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="tareas.html#cb374-1"></a><span class="kw">library</span>(nullabor)</span>
<span id="cb374-2"><a href="tareas.html#cb374-2"></a>ventas.res &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(ventas, period, res.est2<span class="fl">.2</span>)</span>
<span id="cb374-3"><a href="tareas.html#cb374-3"></a>ventas.null &lt;-<span class="st"> </span><span class="kw">lineup</span>(<span class="kw">null_dist</span>(<span class="dt">var =</span> <span class="st">&#39;res.est2.2&#39;</span>, <span class="dt">dist =</span> <span class="st">&#39;normal&#39;</span>, </span>
<span id="cb374-4"><a href="tareas.html#cb374-4"></a>  <span class="dt">params =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="fl">0.08</span>)), <span class="dt">n =</span> <span class="dv">10</span>, ventas.res)</span></code></pre></div>
<pre><code>## decrypt(&quot;bhMq KJPJ 62 sSQ6P6S2 u4&quot;)</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="tareas.html#cb376-1"></a><span class="kw">ggplot</span>(ventas.null, <span class="kw">aes</span>(<span class="dt">x =</span> period, <span class="dt">y =</span> res.est2<span class="fl">.2</span>)) <span class="op">+</span></span>
<span id="cb376-2"><a href="tareas.html#cb376-2"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>.sample, <span class="dt">ncol =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb376-3"><a href="tareas.html#cb376-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb376-4"><a href="tareas.html#cb376-4"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">52</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">52</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">52</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">52</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span>), <span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb376-5"><a href="tareas.html#cb376-5"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">1.2</span>) </span></code></pre></div>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-12-1.png" width="960" /></p>
<p>Hay dos cosas que nos falta explicar, en primer lugar, las caídas alrededor de
principios/finales de cada año (que son de hasta -0.2), y segundo que esta
gráfica parece oscilar demasiado. La estructura que aún no hemos explicado se
debe a que las semanas que caen en quincena tienden a tener compras más
grandes que las que están justo antes de quincena o fin de mes.</p>
<p>Por el momento detendremos el análisis aquí y explicamos un proceso iterativo
para proceder en nuestro análisis exploratorio:</p>
<div class="caja">
<p><strong>Iterando ajuste de loess.</strong> Cuando queremos ajustar con tres componentes:
tendencia, estacionalidad y residuales, podemos seguir el siguiente proceso,</p>
<ol style="list-style-type: decimal">
<li><p>Ajustar la primera componente a los datos (tendencia).</p></li>
<li><p>Ajustar la segunda componente a los residuales del paso anterior
(estacionalidad).</p></li>
<li><p>Restar de los datos originales la segunda componente ajustada
(estacionalidad).</p></li>
<li><p>Ajustar a los residuales del paso anterior una nueva componente (tendencia).</p></li>
<li><p>Restar a los datos originales la componente ajustada en el paso anterior.</p></li>
<li><p>Ajustar a los residuales del paso anterior una nueva componente
(estacionalidad).</p></li>
<li><p>Checar ajuste y si es necesario iterar de 3 a 6 con las nuevas componentes.</p></li>
</ol>
</div>
<p>La idea es que cada componente compite para explicar los datos (cada una gana
más al bajar el parámetro <span class="math inline">\(\alpha\)</span>). El conflicto es que si suavizamos mucho
cada componente (por ejemplo la tendencia), entonces parte de la variación
que debería ir en ella queda en los residuales, y se intenta ajustar
posteriormente por una componente distinta (estacionalidad). Sin embargo, si
suavizamos poco, entonces parte de la variación de la segunda componente es
explicada por el ajuste de la primera. Entonces, la solución es ir poco a poco
adjudicando variación a cada componente. En nuestro ejemplo de arriba, podemos
comenzar suavizando de menos el primer ajsute de la tendencia, luego ajustar
estacionalidad, restar a los datos originales esta estacionalidad, y ajustar a
estos datos una componente más suave de tandencia. Es posible suavizar más la
tendencia justamente porque ya hemos eliminado una buena parte de la
estacionalidad.</p>
</div>
</div>
<div id="tipos-de-estudio-y-pgd" class="section level2 unnumbered">
<h2>3. Tipos de estudio y PGD</h2>
<p>Para cada uno de los siguientes estudios, ubícalos en el recuadro y contesta lo
que se pide. Envíen las respuestas por correo electrónico (con título
fundamentos-tarea03).</p>
<div class="figure">
<img src="images/03_inferencia-muestra.png" alt="" />
<p class="caption">Inferencia estadística de acuerdo al tipo del diseño <span class="citation">(Ramsey and Schafer <a href="#ref-ramsey" role="doc-biblioref">2012</a>)</span>.</p>
</div>
<ol style="list-style-type: decimal">
<li><p>En 1930 se realizó un experimento en 20,000 niños de edad escolar de Inglaterra.
Los maestros fueron los responsables de asignar a los niños de manera aleatoria al
grupo de tratamiento -que consistía en recibir 350 ml de leche diaria - o al
grupo de control, que no recibía suplementos alimenticios. Se registraron peso y
talla antes y después del experimento. El estudio descubrió que los niños que
recibieron la leche ganaron más en peso en el lapso del estudio. Una
investigación posterior descubrió que los niños del grupo control eran de mayor
peso y talla que los del grupo de intervención, antes de iniciar el tratamiento.
¿Qué pudo haber ocurrido? ¿Podemos
utilizar los resultados del estudio para inferir causalidad?</p></li>
<li><p>Supongamos que de los registros de un conjunto de doctores se slecciona una
muestra aleatoria de individuos americanos caucásicos y de americanos de
ascendencia china, con el objetivo de comparar la presión arterial de las dos
poblaciones. Supongamos que a los seleccionados se les pregunta si quieren
participar y algunos rechazan. Se compara la distribución de presión arterial
entre los que accedieron a participar. ¿En que cuadro cae este estudio? ¿Qué
supuesto es necesario para permitir inferencias a las poblaciones muestreadas?</p></li>
<li><p>Un grupo de investigadores reportó que el consumo moderado de alcohol estaba
asociado con un menor riesgo de demencia (Mukamal et al. (2003)). Su muestra
consistía en 373 personas con demencia y 373 sin demencia. A los participantes
se les pregintó cuánta cerveza, vino, o licor consumían. Se observó que aquellos
que consumían de 1-6 bebidas por semana tenían una incidencia menor de demencia
comparado a aquellos que se abstenían del alcohol. ¿se puede inferir causalidad?</p></li>
<li><p>Un estudio descubrió que los niños que ven más de dos horas diarias de
televisión tienden a tener mayores niveles de colesterol que los que ven menos
de dos horas diarias. ¿Cómo se pueden utilizar estos resultados?</p></li>
<li><p>Más gente se enferma de gripa en temporada de invierno, ¿esto prueba que las
temperaturas bajas ocasionan las gripas? ¿Qué otras variables podrían estar
involucradas?</p></li>
<li><p>¿Cuál es la diferencia entre un experimento aleatorizado y una muestra
aleatoria?</p></li>
</ol>
</div>
<div id="pruebas-de-hipótesis-visuales-y-permutación" class="section level2 unnumbered">
<h2>4. Pruebas de hipótesis visuales y permutación</h2>
<p>La tarea 4 es el proyecto de RStudio.Cloud con este nombre, el ejercicio está
en un archvio de R Markdown. Envíen el reporte por correo electrónico (con
título fundamentos-tarea04).</p>
<div id="solución-pruebas-pareadas" class="section level3 unnumbered">
<h3>Solución: Pruebas pareadas</h3>
<p>En este ejemplo buscamos comparar la diferencia entre dos medicinas
para dormir.
- ID es el identificador de paciente, y medicina_1 y medicina_2 son las
horas extras de sueño vs. no usar medicina.<br />
- Examina los datos.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="tareas.html#cb377-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb377-2"><a href="tareas.html#cb377-2"></a></span>
<span id="cb377-3"><a href="tareas.html#cb377-3"></a>dormir &lt;-<span class="st"> </span>sleep <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb377-4"><a href="tareas.html#cb377-4"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> group, </span>
<span id="cb377-5"><a href="tareas.html#cb377-5"></a>              <span class="dt">names_prefix =</span> <span class="st">&quot;medicina_&quot;</span>,</span>
<span id="cb377-6"><a href="tareas.html#cb377-6"></a>              <span class="dt">values_from =</span> extra)</span>
<span id="cb377-7"><a href="tareas.html#cb377-7"></a></span>
<span id="cb377-8"><a href="tareas.html#cb377-8"></a>dormir</span></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    ID    medicina_1 medicina_2
##    &lt;fct&gt;      &lt;dbl&gt;      &lt;dbl&gt;
##  1 1            0.7        1.9
##  2 2           -1.6        0.8
##  3 3           -0.2        1.1
##  4 4           -1.2        0.1
##  5 5           -0.1       -0.1
##  6 6            3.4        4.4
##  7 7            3.7        5.5
##  8 8            0.8        1.6
##  9 9            0          4.6
## 10 10           2          3.4</code></pre>
<p>La pregunta de interés es si una medicina es mejor que otra para prolongar el
sueño. Nótese que en este caso, no tenemos grupos, sino mediciones repetidas.</p>
<ul>
<li>Escribe la hipótesis nula.</li>
</ul>
<p><strong>No hay diferencia entre las medicinas.</strong></p>
<ul>
<li>Nuestra estadśtica de interés es media de las diferencias entre las medicinas. Calcula la diferencia observada.</li>
</ul>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="tareas.html#cb379-1"></a>dif_obs &lt;-<span class="st"> </span>dormir <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb379-2"><a href="tareas.html#cb379-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dif =</span> medicina_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>medicina_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb379-3"><a href="tareas.html#cb379-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">dif_obs =</span> <span class="kw">mean</span>(dif)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb379-4"><a href="tareas.html#cb379-4"></a><span class="st">  </span><span class="kw">pull</span>(dif_obs)</span>
<span id="cb379-5"><a href="tareas.html#cb379-5"></a>dif_obs</span></code></pre></div>
<pre><code>## [1] -1.58</code></pre>
<ul>
<li>Hay variación entre los pacientes. ¿Tenemos evidencia para rechazar que son
iguales? ¿Cómo hacemos nuestra distribución de referencia?</li>
</ul>
<p><strong>Bajo la hipótesis nula las medicinas son intercambiables, debemos
la columna de medicina <em>por individuo</em> pues cada uno debe
tener un valor de medicina 1 y uno de medicina 2</strong>.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="tareas.html#cb381-1"></a>dormir_larga &lt;-<span class="st"> </span>dormir <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb381-2"><a href="tareas.html#cb381-2"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">contains</span>(<span class="st">&quot;medicina&quot;</span>))</span>
<span id="cb381-3"><a href="tareas.html#cb381-3"></a><span class="co"># Hacemos una permutación </span></span>
<span id="cb381-4"><a href="tareas.html#cb381-4"></a>dormir_perm &lt;-<span class="st"> </span>dormir_larga <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb381-5"><a href="tareas.html#cb381-5"></a><span class="st">  </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb381-6"><a href="tareas.html#cb381-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;medicina_1&quot;</span>, <span class="st">&quot;medicina_2&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb381-7"><a href="tareas.html#cb381-7"></a><span class="st">  </span><span class="kw">ungroup</span>()</span>
<span id="cb381-8"><a href="tareas.html#cb381-8"></a><span class="co"># Calculamos la estadística en esta permutación</span></span>
<span id="cb381-9"><a href="tareas.html#cb381-9"></a>dormir_perm <span class="op">%&gt;%</span></span>
<span id="cb381-10"><a href="tareas.html#cb381-10"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="dt">values_from =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb381-11"><a href="tareas.html#cb381-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dif =</span> medicina_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>medicina_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb381-12"><a href="tareas.html#cb381-12"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">media_dif =</span> <span class="kw">mean</span>(dif)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb381-13"><a href="tareas.html#cb381-13"></a><span class="st">  </span><span class="kw">pull</span>(media_dif)</span></code></pre></div>
<pre><code>## [1] -0.02</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="tareas.html#cb383-1"></a><span class="co"># Lo hacemos una función </span></span>
<span id="cb383-2"><a href="tareas.html#cb383-2"></a>calcula_est &lt;-<span class="st"> </span><span class="cf">function</span>(){</span>
<span id="cb383-3"><a href="tareas.html#cb383-3"></a>  dormir_perm &lt;-<span class="st"> </span>dormir_larga <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb383-4"><a href="tareas.html#cb383-4"></a><span class="st">    </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb383-5"><a href="tareas.html#cb383-5"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;medicina_1&quot;</span>, <span class="st">&quot;medicina_2&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb383-6"><a href="tareas.html#cb383-6"></a><span class="st">    </span><span class="kw">ungroup</span>()</span>
<span id="cb383-7"><a href="tareas.html#cb383-7"></a>  dormir_perm <span class="op">%&gt;%</span></span>
<span id="cb383-8"><a href="tareas.html#cb383-8"></a><span class="st">    </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="dt">values_from =</span> <span class="st">&quot;value&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb383-9"><a href="tareas.html#cb383-9"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">dif =</span> medicina_<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>medicina_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb383-10"><a href="tareas.html#cb383-10"></a><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">media_dif =</span> <span class="kw">mean</span>(dif)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb383-11"><a href="tareas.html#cb383-11"></a><span class="st">    </span><span class="kw">pull</span>(media_dif)</span>
<span id="cb383-12"><a href="tareas.html#cb383-12"></a>}</span>
<span id="cb383-13"><a href="tareas.html#cb383-13"></a><span class="co"># La llamamos 1000 veces</span></span>
<span id="cb383-14"><a href="tareas.html#cb383-14"></a><span class="kw">calcula_est</span>()</span></code></pre></div>
<pre><code>## [1] -0.6</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="tareas.html#cb385-1"></a>difs &lt;-<span class="st"> </span><span class="kw">rerun</span>(<span class="dv">1000</span>, <span class="kw">calcula_est</span>()) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">flatten_dbl</span>()</span></code></pre></div>
<ul>
<li>Haz una gráfica de la distribución de referencia y grafica encima el valor
observado en los datos originales.</li>
</ul>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="tareas.html#cb386-1"></a>perms &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">sims =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, <span class="dt">difs =</span> difs)</span>
<span id="cb386-2"><a href="tareas.html#cb386-2"></a><span class="kw">ggplot</span>(perms, <span class="kw">aes</span>(<span class="dt">x =</span> difs)) <span class="op">+</span></span>
<span id="cb386-3"><a href="tareas.html#cb386-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.20</span>) <span class="op">+</span></span>
<span id="cb386-4"><a href="tareas.html#cb386-4"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> dif_obs, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-16-1.png" width="336" /></p>
</div>
</div>
<div id="distribución-muestral-y-remuestreo" class="section level2 unnumbered">
<h2>5. Distribución muestral y remuestreo</h2>
<p>La tarea 5 es el proyecto de RStudio.Cloud con este nombre, el ejercicio está
en un archvio de R Markdown. Envíen el reporte por correo electrónico (con
título fundamentos-tarea05).</p>
</div>
<div id="tcl-e-introducción-a-bootstrap" class="section level2 unnumbered">
<h2>6. TCL e introducción a bootstrap</h2>
<p>La tarea 6 es el proyecto de RStudio.Cloud con este nombre, los ejercicios
están descritos en un archivo de R. Envíen un reporte por correo electrónico con
las respuestas (con título fundamentos-tarea06).</p>
<div id="solución-y-discusión-de-media" class="section level3 unnumbered">
<h3>Solución y discusión de media</h3>
<div id="ejemplo-el-error-estándar-de-una-media" class="section level4 unnumbered">
<h4>Ejemplo: el error estándar de una media</h4>
<p>Supongamos que <span class="math inline">\(x\)</span> es una variable aleatoria que toma valores en los reales con
distribución de probabilidad <span class="math inline">\(P\)</span>. Denotamos por <span class="math inline">\(\mu_F\)</span> y <span class="math inline">\(\sigma_F^2\)</span> la
media y varianza de <span class="math inline">\(P\)</span>,</p>
<p><span class="math display">\[\mu_F = E_F(x),\]</span>
<span class="math display">\[\sigma_F^2=var_F(x)=E_F[(x-\mu)^2]\]</span></p>
<p>en la notación enfatizamos la dependencia de la media y varianza en la
distribución <span class="math inline">\(P\)</span>.</p>
<p>Ahora, sea <span class="math inline">\((x_1,...,x_n)\)</span> una muestra aleatoria de <span class="math inline">\(P\)</span>, de tamaño <span class="math inline">\(n\)</span>,
la media de la muestra <span class="math inline">\(\bar{x}=\sum_{i=1}^nx_i/n\)</span> tiene:</p>
<ul>
<li><p>esperanza <span class="math inline">\(\mu_F\)</span>,</p></li>
<li><p>varianza <span class="math inline">\(\sigma_F^2/n\)</span>.</p></li>
</ul>
<p>En palabras: la esperanza de <span class="math inline">\(\bar{x}\)</span> es la misma que la esperanza de <span class="math inline">\(x\)</span>, pero
la varianza de <span class="math inline">\(\bar{x}\)</span> es <span class="math inline">\(1/n\)</span> veces la varianza de <span class="math inline">\(x\)</span>, así que entre
mayor es la <span class="math inline">\(n\)</span> tenemos una mejor estimación de <span class="math inline">\(\mu_P\)</span>.</p>
<p>En el caso de la media <span class="math inline">\(\bar{x}\)</span>, el error estándar, que denotamos
<span class="math inline">\(se_P(\bar{x})\)</span>, es la raíz de la varianza de <span class="math inline">\(\bar{x}\)</span>,</p>
<p><span class="math display">\[se_F(\bar{x}) = [var_F(\bar{x})]^{1/2}= \sigma_F/ \sqrt{n}.\]</span></p>
<p>En este punto podemos usar el principio del <em>plug-in</em>, simplemente sustituimos
<span class="math inline">\(P_n\)</span> por <span class="math inline">\(P\)</span> y obtenemos, primero, una estimación de <span class="math inline">\(\sigma_P\)</span>:
<span class="math display">\[\hat{\sigma}=\hat{\sigma}_{\hat{F}} = \bigg\{\frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^2\bigg\}^{1/2}\]</span></p>
<p>de donde se sigue la estimación del error estándar:</p>
<p><span class="math display">\[\hat{ee}(\bar{x})=\hat{\sigma}_{\hat{F}}/\sqrt{n}=\bigg\{\frac{1}{n^2}\sum_{i=1}^n(x_i-\bar{x})^2\bigg\}^{1/2}\]</span></p>
<p>Notemos que usamos el principio del <em>plug-in</em> en dos ocasiones, primero para
estimar la esperanza <span class="math inline">\(\mu_F\)</span> mediante <span class="math inline">\(\mu_{\hat{F}}\)</span> y luego para estimar el
error estándar <span class="math inline">\(ee_F(\bar{x})\)</span>.</p>
<p>Consideramos los datos de ENLACE edo. de México
(<code>enlace</code>), y la columna de calificaciones de español 3<sup>o</sup> de primaria (<code>esp_3</code>).</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="tareas.html#cb387-1"></a>enlace &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/enlace_15.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   id = col_double(),
##   cve_ent = col_double(),
##   turno = col_character(),
##   tipo = col_character(),
##   esp_3 = col_double(),
##   esp_6 = col_double(),
##   n_eval_3 = col_double(),
##   n_eval_6 = col_double()
## )</code></pre>
<p>Suponemos que me interesa hacer inferencia del promedio de las
calificaciones de los estudiantes de tercero de primaria en el Estado de México.</p>
<p>En este ejercicio planteamos <span class="math inline">\(3\)</span> escenarios (que simulamos): 1) que tengo una
muestra de tamaño <span class="math inline">\(10\)</span>, 2) que tengo una muestra de tamaño <span class="math inline">\(100\)</span>, y 3) que tengo una
muestra de tamaño <span class="math inline">\(1000\)</span>.</p>
<ul>
<li>Selección de muestras:</li>
</ul>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="tareas.html#cb389-1"></a><span class="kw">set.seed</span>(<span class="dv">373783326</span>)</span>
<span id="cb389-2"><a href="tareas.html#cb389-2"></a>muestras &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">tamanos =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb389-3"><a href="tareas.html#cb389-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">muestras =</span> <span class="kw">map</span>(tamanos, <span class="op">~</span><span class="kw">sample</span>(enlace<span class="op">$</span>esp_<span class="dv">3</span>, <span class="dt">size =</span> .)))</span></code></pre></div>
<p>Ahora procedemos de manera <em>usual</em> en estadística (usando fórmulas y no
simulación), estimo la media de la muestra con el estimador <em>plug-in</em></p>
<p><span class="math display">\[\bar{x}={1/n\sum x_i}\]</span></p>
<p>y el error estándar de <span class="math inline">\(\bar{x}\)</span> con el estimador <em>plug-in</em>, en el caso de la
media hay una fórmula, pero cómo calculamos el error estándar de una mediana?,
o de una correlación?</p>
<p><span class="math display">\[\hat{ee}(\bar{x}) =\bigg\{\frac{1}{n^2}\sum_{i=1}^n(x_i-\bar{x})^2\bigg\}^{1/2}\]</span></p>
<ul>
<li>Estimadores <em>plug-in</em>:</li>
</ul>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="tareas.html#cb390-1"></a>se_plug_in &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb390-2"><a href="tareas.html#cb390-2"></a>    x_bar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb390-3"><a href="tareas.html#cb390-3"></a>    n_x &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb390-4"><a href="tareas.html#cb390-4"></a>    var_x &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>n_x <span class="op">^</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span>x_bar) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb390-5"><a href="tareas.html#cb390-5"></a>    <span class="kw">sqrt</span>(var_x)</span>
<span id="cb390-6"><a href="tareas.html#cb390-6"></a>}</span>
<span id="cb390-7"><a href="tareas.html#cb390-7"></a>muestras_est &lt;-<span class="st"> </span>muestras <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb390-8"><a href="tareas.html#cb390-8"></a><span class="st">    </span><span class="kw">mutate</span>(</span>
<span id="cb390-9"><a href="tareas.html#cb390-9"></a>        <span class="dt">medias =</span> <span class="kw">map_dbl</span>(muestras, mean), </span>
<span id="cb390-10"><a href="tareas.html#cb390-10"></a>        <span class="dt">e_estandar_plug_in =</span> <span class="kw">map_dbl</span>(muestras, se_plug_in)</span>
<span id="cb390-11"><a href="tareas.html#cb390-11"></a>    )</span>
<span id="cb390-12"><a href="tareas.html#cb390-12"></a>muestras_est</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   tamanos muestras      medias e_estandar_plug_in
##     &lt;dbl&gt; &lt;list&gt;         &lt;dbl&gt;              &lt;dbl&gt;
## 1      10 &lt;dbl [10]&gt;      602.              19.3 
## 2     100 &lt;dbl [100]&gt;     553.               6.54
## 3    1000 &lt;dbl [1,000]&gt;   552.               1.90</code></pre>
<p>Ahora, recordemos que la distribución muestral es la distribución de una
estadística, considerada como una variable aleatoria. Usando esta definción
podemos aproximarla, para cada tamaño de muestra, simulando:</p>
<ol style="list-style-type: decimal">
<li>simulamos muestras de tamaño <span class="math inline">\(n\)</span> de la población,<br />
</li>
<li>calculamos la estadística de interés (en este caso <span class="math inline">\(\bar{x}\)</span>),<br />
</li>
<li>vemos la distribución de la estadística a lo largo de simulaciones.</li>
</ol>
<ul>
<li>Histogramas de distribución muestral y aproximación de errores estándar con
simulación</li>
</ul>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="tareas.html#cb392-1"></a>muestras_sims &lt;-<span class="st"> </span>muestras_est <span class="op">%&gt;%</span></span>
<span id="cb392-2"><a href="tareas.html#cb392-2"></a><span class="st">    </span><span class="kw">mutate</span>(</span>
<span id="cb392-3"><a href="tareas.html#cb392-3"></a>        <span class="dt">sims_muestras =</span> <span class="kw">map</span>(tamanos, <span class="op">~</span><span class="kw">rerun</span>(<span class="dv">10000</span>, <span class="kw">sample</span>(enlace<span class="op">$</span>esp_<span class="dv">3</span>, </span>
<span id="cb392-4"><a href="tareas.html#cb392-4"></a>            <span class="dt">size =</span> ., <span class="dt">replace =</span> <span class="ot">TRUE</span>))), </span>
<span id="cb392-5"><a href="tareas.html#cb392-5"></a>        <span class="dt">sims_medias =</span> <span class="kw">map</span>(sims_muestras, <span class="op">~</span><span class="kw">map_dbl</span>(., mean)), </span>
<span id="cb392-6"><a href="tareas.html#cb392-6"></a>        <span class="dt">e_estandar_aprox =</span> <span class="kw">map_dbl</span>(sims_medias, sd)</span>
<span id="cb392-7"><a href="tareas.html#cb392-7"></a>        )</span>
<span id="cb392-8"><a href="tareas.html#cb392-8"></a>sims_medias &lt;-<span class="st"> </span>muestras_sims <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb392-9"><a href="tareas.html#cb392-9"></a><span class="st">    </span><span class="kw">select</span>(tamanos, sims_medias) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb392-10"><a href="tareas.html#cb392-10"></a><span class="st">    </span><span class="kw">unnest</span>(sims_medias) </span>
<span id="cb392-11"><a href="tareas.html#cb392-11"></a></span>
<span id="cb392-12"><a href="tareas.html#cb392-12"></a><span class="kw">ggplot</span>(sims_medias, <span class="kw">aes</span>(<span class="dt">x =</span> sims_medias)) <span class="op">+</span></span>
<span id="cb392-13"><a href="tareas.html#cb392-13"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb392-14"><a href="tareas.html#cb392-14"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>tamanos, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb392-15"><a href="tareas.html#cb392-15"></a><span class="st">    </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-21-1.png" width="672" height="350px" /></p>
<p>Notamos que la variación en la distribución muestral decrece conforme aumenta
el tamaño de muestra, esto es esperado pues el error estándar de una media
es <span class="math inline">\(\sigma_P / \sqrt{n}\)</span>, y dado que en este ejemplo estamos calculando la media
para la misma población el valor poblacional <span class="math inline">\(\sigma_P\)</span> es constante y solo
cambia el denominador.</p>
<p>Nuestros valores de error estándar con simulación están en la columna
<code>e_estandar_aprox</code>:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="tareas.html#cb393-1"></a>muestras_sims <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb393-2"><a href="tareas.html#cb393-2"></a><span class="st">    </span><span class="kw">select</span>(tamanos, medias, e_estandar_plug_in, e_estandar_aprox)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   tamanos medias e_estandar_plug_in e_estandar_aprox
##     &lt;dbl&gt;  &lt;dbl&gt;              &lt;dbl&gt;            &lt;dbl&gt;
## 1      10   602.              19.3             18.9 
## 2     100   553.               6.54             5.92
## 3    1000   552.               1.90             1.87</code></pre>
<p>En este ejercicio estamos simulando para examinar las distribuciones muestrales
y para ver que podemos aproximar el error estándar de la media usando
simulación; sin embargo, dado que en este caso hipotético conocemos la varianza
poblacional y la fórmula del error estándar de una media, por lo que podemos
calcular el verdadero error estándar para una muestra de cada tamaño.</p>
<ul>
<li>Calcula el error estándar de la media para cada tamaño de muestra usando la
información poblacional:</li>
</ul>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="tareas.html#cb395-1"></a>muestras_sims_est &lt;-<span class="st"> </span>muestras_sims <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb395-2"><a href="tareas.html#cb395-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">e_estandar_pob =</span> <span class="kw">sd</span>(enlace<span class="op">$</span>esp_<span class="dv">3</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(tamanos))</span>
<span id="cb395-3"><a href="tareas.html#cb395-3"></a>muestras_sims_est <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb395-4"><a href="tareas.html#cb395-4"></a><span class="st">    </span><span class="kw">select</span>(tamanos, e_estandar_plug_in, e_estandar_aprox, e_estandar_pob)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   tamanos e_estandar_plug_in e_estandar_aprox e_estandar_pob
##     &lt;dbl&gt;              &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
## 1      10              19.3             18.9           18.7 
## 2     100               6.54             5.92           5.93
## 3    1000               1.90             1.87           1.87</code></pre>
<p>En la tabla de arriba podemos comparar los <span class="math inline">\(3\)</span> errores estándar que calculamos,
recordemos que de estos <span class="math inline">\(3\)</span> el <em>plug-in</em> es el único que podríamos obtener en
un escenario real pues los otros dos los calculamos usando la población.</p>
<p>Una alternativa al estimador <em>plug-in</em> del error estándar es usar <em>bootstrap</em>
(en muchos casos no podemos calcular el error estándar <em>plug-in</em> por falta de
fórmulas) pero podemos usar <em>bootstrap</em>: utilizamos una
estimación de la distribución poblacional y calculamos el error estándar
bootstrap usando simulación. Hacemos el mismo procedimiento que usamos para
calcular <em>e_estandar_apox</em> pero sustituimos la distribución poblacional por la
distriución empírica. Hagámoslo usando las muestras que sacamos en el primer
paso:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="tareas.html#cb397-1"></a>muestras_sims_est_boot &lt;-<span class="st"> </span>muestras_sims_est <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb397-2"><a href="tareas.html#cb397-2"></a><span class="st">    </span><span class="kw">mutate</span>(</span>
<span id="cb397-3"><a href="tareas.html#cb397-3"></a>        <span class="dt">sims_muestras_boot =</span> <span class="kw">map2</span>(muestras, tamanos,</span>
<span id="cb397-4"><a href="tareas.html#cb397-4"></a>            <span class="op">~</span><span class="kw">rerun</span>(<span class="dv">10000</span>, <span class="kw">sample</span>(.x, <span class="dt">size =</span> .y, <span class="dt">replace =</span> <span class="ot">TRUE</span>))), </span>
<span id="cb397-5"><a href="tareas.html#cb397-5"></a>        <span class="dt">sims_medias_boot =</span> <span class="kw">map</span>(sims_muestras_boot, <span class="op">~</span><span class="kw">map_dbl</span>(., mean)), </span>
<span id="cb397-6"><a href="tareas.html#cb397-6"></a>        <span class="dt">e_estandar_boot =</span> <span class="kw">map_dbl</span>(sims_medias_boot, sd)</span>
<span id="cb397-7"><a href="tareas.html#cb397-7"></a>        )</span>
<span id="cb397-8"><a href="tareas.html#cb397-8"></a>muestras_sims_est_boot</span></code></pre></div>
<pre><code>## # A tibble: 3 x 11
##   tamanos muestras medias e_estandar_plug… sims_muestras sims_medias
##     &lt;dbl&gt; &lt;list&gt;    &lt;dbl&gt;            &lt;dbl&gt; &lt;list&gt;        &lt;list&gt;     
## 1      10 &lt;dbl [1…   602.            19.3  &lt;list [10,00… &lt;dbl [10,0…
## 2     100 &lt;dbl [1…   553.             6.54 &lt;list [10,00… &lt;dbl [10,0…
## 3    1000 &lt;dbl [1…   552.             1.90 &lt;list [10,00… &lt;dbl [10,0…
## # … with 5 more variables: e_estandar_aprox &lt;dbl&gt;, e_estandar_pob &lt;dbl&gt;,
## #   sims_muestras_boot &lt;list&gt;, sims_medias_boot &lt;list&gt;, e_estandar_boot &lt;dbl&gt;</code></pre>
<p>Graficamos los histogramas de la distribución bootstrap para cada muestra.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="tareas.html#cb399-1"></a>sims_medias_boot &lt;-<span class="st"> </span>muestras_sims_est_boot <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb399-2"><a href="tareas.html#cb399-2"></a><span class="st">    </span><span class="kw">select</span>(tamanos, sims_medias_boot) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb399-3"><a href="tareas.html#cb399-3"></a><span class="st">    </span><span class="kw">unnest</span>(sims_medias_boot) </span>
<span id="cb399-4"><a href="tareas.html#cb399-4"></a></span>
<span id="cb399-5"><a href="tareas.html#cb399-5"></a><span class="kw">ggplot</span>(sims_medias_boot, <span class="kw">aes</span>(<span class="dt">x =</span> sims_medias_boot)) <span class="op">+</span></span>
<span id="cb399-6"><a href="tareas.html#cb399-6"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb399-7"><a href="tareas.html#cb399-7"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>tamanos, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb399-8"><a href="tareas.html#cb399-8"></a><span class="st">    </span><span class="kw">theme_minimal</span>()</span></code></pre></div>
<p><img src="98-tareas_files/figure-html/unnamed-chunk-25-1.png" width="672" height="350px" /></p>
<p>Y la tabla con todos los errores estándar quedaría:</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="tareas.html#cb400-1"></a>muestras_sims_est_boot <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb400-2"><a href="tareas.html#cb400-2"></a><span class="st">    </span><span class="kw">select</span>(tamanos, e_estandar_boot, e_estandar_plug_in, e_estandar_aprox, </span>
<span id="cb400-3"><a href="tareas.html#cb400-3"></a>        e_estandar_pob)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   tamanos e_estandar_boot e_estandar_plug_in e_estandar_aprox e_estandar_pob
##     &lt;dbl&gt;           &lt;dbl&gt;              &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
## 1      10           19.3               19.3             18.9           18.7 
## 2     100            6.53               6.54             5.92           5.93
## 3    1000            1.89               1.90             1.87           1.87</code></pre>
<p>Observamos que el estimador bootstrap del error estándar es muy similar al
estimador plug-in del error estándar, esto es esperado pues se calcularon con la
misma muestra y el error estándar <em>bootstrap</em> converge al <em>plug-in</em> conforme
incrementamos el número de muestras <em>bootstrap</em>.</p>
</div>
<div id="por-qué-bootstrap" class="section level4 unnumbered">
<h4>¿Por qué bootstrap?</h4>
<ul>
<li><p>En el caso de la media <span class="math inline">\(\hat{\theta}=\bar{x}\)</span> la aplicación del principio del
<em>plug-in</em> para el cálculo de errores estándar es inmediata; sin embargo, hay
estadísticas para las cuáles no es fácil aplicar este método.</p></li>
<li><p>El método de aproximarlo con simulación, como lo hicimos en el ejercicio de
arriba no es factible pues en la práctica no podemos seleccionar un número
arbitrario de muestras de la población, sino que tenemos únicamente una muestra.</p></li>
<li><p>La idea del <em>bootstrap</em> es replicar el método de simulación para aproximar
el error estándar, esto es seleccionar muchas muestras y calcular la estadística
de interés en cada una, con la diferencia que las muestras se seleccionan de la
distribución empírica a falta de la distribución poblacional.</p></li>
</ul>

</div>
</div>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-ramsey">
<p>Ramsey, Fred, and Daniel Schafer. 2012. <em>The Statistical Sleuth: A Course in Methods of Data Analysis</em>. Cengage Learning.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimación-por-máxima-verosimilitud.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tereom/fundamentos/edit/master/98-tareas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fundamentos-estadistica.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
